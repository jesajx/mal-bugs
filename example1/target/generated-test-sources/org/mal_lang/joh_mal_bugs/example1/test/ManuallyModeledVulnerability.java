package org.mal_lang.joh_mal_bugs.example1.test;

import core.AttackStep;
import core.Defense;
import java.lang.Boolean;
import java.lang.Override;
import java.lang.String;
import java.util.HashSet;
import java.util.Set;

public abstract class ManuallyModeledVulnerability extends Vulnerability {
  private Set<Application> _cachereverseallManualVulnerabilitiesApplication;

  public ManuallyModeledVulnerability(String name, boolean isUserInteractsEnabled,
      boolean isRemoveEnabled) {
    super(name, isUserInteractsEnabled, isRemoveEnabled);
    assetClassName = "ManuallyModeledVulnerability";
    if (userInteracts != null) {
      AttackStep.allAttackSteps.remove(userInteracts.disable);
    }
    Defense.allDefenses.remove(userInteracts);
    userInteracts = new UserInteracts(name, isUserInteractsEnabled);
  }

  public ManuallyModeledVulnerability(String name) {
    super(name);
    assetClassName = "ManuallyModeledVulnerability";
    if (userInteracts != null) {
      AttackStep.allAttackSteps.remove(userInteracts.disable);
    }
    Defense.allDefenses.remove(userInteracts);
    userInteracts = new UserInteracts(name, true);
  }

  public ManuallyModeledVulnerability(boolean isUserInteractsEnabled, boolean isRemoveEnabled) {
    this("Anonymous", isUserInteractsEnabled, isRemoveEnabled);
  }

  public ManuallyModeledVulnerability() {
    this("Anonymous");
  }

  protected Set<Application> _reverseallManualVulnerabilitiesApplication() {
    if (_cachereverseallManualVulnerabilitiesApplication == null) {
      _cachereverseallManualVulnerabilitiesApplication = new HashSet<>();
      Set<Application> _0 = new HashSet<>();
      Set<Application> _1 = new HashSet<>();
      if (ManuallyModeledVulnerability.this instanceof ManuallyModeledVulnerability) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.ManuallyModeledVulnerability) ManuallyModeledVulnerability.this).softwareProduct != null) {
          for (Application _2 : ((org.mal_lang.joh_mal_bugs.example1.test.ManuallyModeledVulnerability) ManuallyModeledVulnerability.this).softwareProduct.softApplications) {
            _0.add(_2);
          }
        }
      }
      if (application != null) {
        _1.add(application);
      }
      _0.addAll(_1);
      for (Application _3 : _0) {
        _cachereverseallManualVulnerabilitiesApplication.add(_3);
      }
    }
    return _cachereverseallManualVulnerabilitiesApplication;
  }

  public class UserInteracts extends Vulnerability.UserInteracts {
    public UserInteracts(String name) {
      this(name, true);
    }

    public UserInteracts(String name, Boolean isEnabled) {
      super(name);
      defaultValue = isEnabled;
      disable = new Disable(name);
    }

    public class Disable extends Vulnerability.UserInteracts.Disable {
      private Set<AttackStep> _cacheChildrenUserInteracts;

      public Disable(String name) {
        super(name);
      }

      @Override
      public void updateChildren(Set<AttackStep> attackSteps) {
        if (_cacheChildrenUserInteracts == null) {
          _cacheChildrenUserInteracts = new HashSet<>();
          if (ManuallyModeledVulnerability.this instanceof ManuallyModeledVulnerability) {
            _cacheChildrenUserInteracts.add(((org.mal_lang.joh_mal_bugs.example1.test.ManuallyModeledVulnerability) ManuallyModeledVulnerability.this).abuse);
          }
        }
        for (AttackStep attackStep : _cacheChildrenUserInteracts) {
          attackStep.updateTtc(this, ttc, attackSteps);
        }
      }

      @Override
      public Set<AttackStep> getAttackStepChildren() {
        var tmp = super.getAttackStepChildren();
        if (ManuallyModeledVulnerability.this instanceof ManuallyModeledVulnerability) {
          tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.ManuallyModeledVulnerability) ManuallyModeledVulnerability.this).abuse);
        }
        return tmp;
      }

      @Override
      public String fullName() {
        return "ManuallyModeledVulnerability.userInteracts";
      }
    }
  }
}
