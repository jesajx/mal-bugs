package org.mal_lang.joh_mal_bugs.example1.test;

import core.AttackStep;
import java.lang.Override;
import java.lang.String;
import java.util.HashSet;
import java.util.Set;

public abstract class AutomaticHighComplexityVulnerability extends AutomaticallyModeledVulnerability {
  public AutomaticHighComplexityVulnerability(String name, boolean isUserInteractsEnabled,
      boolean isRemoveEnabled) {
    super(name, isUserInteractsEnabled, isRemoveEnabled);
    assetClassName = "AutomaticHighComplexityVulnerability";
    AttackStep.allAttackSteps.remove(abuse);
    abuse = new Abuse(name);
  }

  public AutomaticHighComplexityVulnerability(String name) {
    super(name);
    assetClassName = "AutomaticHighComplexityVulnerability";
    AttackStep.allAttackSteps.remove(abuse);
    abuse = new Abuse(name);
  }

  public AutomaticHighComplexityVulnerability(boolean isUserInteractsEnabled,
      boolean isRemoveEnabled) {
    this("Anonymous", isUserInteractsEnabled, isRemoveEnabled);
  }

  public AutomaticHighComplexityVulnerability() {
    this("Anonymous");
  }

  public class Abuse extends Vulnerability.Abuse {
    private Set<AttackStep> _cacheChildrenAbuse;

    private Set<AttackStep> _cacheParentAbuse;

    public Abuse(String name) {
      super(name);
    }

    @Override
    public void updateChildren(Set<AttackStep> attackSteps) {
      if (_cacheChildrenAbuse == null) {
        _cacheChildrenAbuse = new HashSet<>();
        if (AutomaticHighComplexityVulnerability.this instanceof AutomaticHighComplexityVulnerability) {
          for (Exploit _0 : ((org.mal_lang.joh_mal_bugs.example1.test.AutomaticHighComplexityVulnerability) AutomaticHighComplexityVulnerability.this).exploits) {
            _cacheChildrenAbuse.add(_0.attemptExploit);
          }
        }
      }
      for (AttackStep attackStep : _cacheChildrenAbuse) {
        attackStep.updateTtc(this, ttc, attackSteps);
      }
    }

    @Override
    public Set<AttackStep> getAttackStepChildren() {
      var tmp = super.getAttackStepChildren();
      if (AutomaticHighComplexityVulnerability.this instanceof AutomaticHighComplexityVulnerability) {
        for (Exploit _1 : ((org.mal_lang.joh_mal_bugs.example1.test.AutomaticHighComplexityVulnerability) AutomaticHighComplexityVulnerability.this).exploits) {
          tmp.add(_1.attemptExploit);
        }
      }
      return tmp;
    }

    @Override
    public void setExpectedParents() {
      super.setExpectedParents();
      if (_cacheParentAbuse == null) {
        _cacheParentAbuse = new HashSet<>();
        if (AutomaticHighComplexityVulnerability.this instanceof LHNRVulnerability) {
          _cacheParentAbuse.add(((org.mal_lang.joh_mal_bugs.example1.test.LHNRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticHighComplexityVulnerability.this instanceof LHLRVulnerability) {
          _cacheParentAbuse.add(((org.mal_lang.joh_mal_bugs.example1.test.LHLRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticHighComplexityVulnerability.this instanceof LHHRVulnerability) {
          _cacheParentAbuse.add(((org.mal_lang.joh_mal_bugs.example1.test.LHHRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticHighComplexityVulnerability.this instanceof NHNRVulnerability) {
          _cacheParentAbuse.add(((org.mal_lang.joh_mal_bugs.example1.test.NHNRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticHighComplexityVulnerability.this instanceof NHLRVulnerability) {
          _cacheParentAbuse.add(((org.mal_lang.joh_mal_bugs.example1.test.NHLRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
        }
        if (AutomaticHighComplexityVulnerability.this instanceof NHHRVulnerability) {
          _cacheParentAbuse.add(((org.mal_lang.joh_mal_bugs.example1.test.NHHRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
        }
      }
      for (AttackStep attackStep : _cacheParentAbuse) {
        addExpectedParent(attackStep);
      }
    }

    @Override
    public Set<AttackStep> getAttackStepParents() {
      var tmp = super.getAttackStepParents();
      if (AutomaticHighComplexityVulnerability.this instanceof LHNRVulnerability) {
        tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.LHNRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
      }
      if (AutomaticHighComplexityVulnerability.this instanceof LHLRVulnerability) {
        tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.LHLRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
      }
      if (AutomaticHighComplexityVulnerability.this instanceof LHHRVulnerability) {
        tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.LHHRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
      }
      if (AutomaticHighComplexityVulnerability.this instanceof NHNRVulnerability) {
        tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.NHNRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
      }
      if (AutomaticHighComplexityVulnerability.this instanceof NHLRVulnerability) {
        tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.NHLRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
      }
      if (AutomaticHighComplexityVulnerability.this instanceof NHHRVulnerability) {
        tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.NHHRVulnerability) AutomaticHighComplexityVulnerability.this).userInteracts.disable);
      }
      return tmp;
    }

    @Override
    public double localTtc() {
      return ttcHashMap.get("AutomaticHighComplexityVulnerability.abuse");
    }
  }
}
