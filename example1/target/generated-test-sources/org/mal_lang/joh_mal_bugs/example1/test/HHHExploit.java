package org.mal_lang.joh_mal_bugs.example1.test;

import core.AttackStep;
import java.lang.Override;
import java.lang.String;
import java.util.HashSet;
import java.util.Set;

public class HHHExploit extends AutomaticExploit {
  public HHHExploit(String name) {
    super(name);
    assetClassName = "HHHExploit";
    AttackStep.allAttackSteps.remove(impact);
    impact = new Impact(name);
  }

  public HHHExploit() {
    this("Anonymous");
  }

  public class Impact extends Exploit.Impact {
    private Set<AttackStep> _cacheChildrenImpact;

    public Impact(String name) {
      super(name);
    }

    @Override
    public void updateChildren(Set<AttackStep> attackSteps) {
      if (_cacheChildrenImpact == null) {
        _cacheChildrenImpact = new HashSet<>();
        if (HHHExploit.this instanceof HHHExploit) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability != null) {
            if (((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability.application != null) {
              _cacheChildrenImpact.add(((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability.application.codeExecutionAfterVulnerability);
            }
          }
        }
        if (HHHExploit.this instanceof HHHExploit) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability != null) {
            if (((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability.softwareProduct != null) {
              _cacheChildrenImpact.add(((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability.softwareProduct.compromiseApplication);
            }
          }
        }
      }
      for (AttackStep attackStep : _cacheChildrenImpact) {
        attackStep.updateTtc(this, ttc, attackSteps);
      }
    }

    @Override
    public Set<AttackStep> getAttackStepChildren() {
      var tmp = super.getAttackStepChildren();
      if (HHHExploit.this instanceof HHHExploit) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability != null) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability.application != null) {
            tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability.application.codeExecutionAfterVulnerability);
          }
        }
      }
      if (HHHExploit.this instanceof HHHExploit) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability != null) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability.softwareProduct != null) {
            tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.HHHExploit) HHHExploit.this).vulnerability.softwareProduct.compromiseApplication);
          }
        }
      }
      return tmp;
    }

    @Override
    public double localTtc() {
      return ttcHashMap.get("HHHExploit.impact");
    }
  }
}
