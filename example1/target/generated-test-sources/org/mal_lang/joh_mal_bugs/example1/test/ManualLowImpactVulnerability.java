package org.mal_lang.joh_mal_bugs.example1.test;

import core.AttackStep;
import core.AttackStepMin;
import java.lang.Override;
import java.lang.String;
import java.util.HashSet;
import java.util.Set;

public class ManualLowImpactVulnerability extends ManuallyModeledVulnerability {
  public LowImpact lowImpact;

  public ManualLowImpactVulnerability(String name, boolean isUserInteractsEnabled,
      boolean isRemoveEnabled) {
    super(name, isUserInteractsEnabled, isRemoveEnabled);
    assetClassName = "ManualLowImpactVulnerability";
    AttackStep.allAttackSteps.remove(impact);
    impact = new Impact(name);
    AttackStep.allAttackSteps.remove(lowImpact);
    lowImpact = new LowImpact(name);
  }

  public ManualLowImpactVulnerability(String name) {
    super(name);
    assetClassName = "ManualLowImpactVulnerability";
    AttackStep.allAttackSteps.remove(impact);
    impact = new Impact(name);
    AttackStep.allAttackSteps.remove(lowImpact);
    lowImpact = new LowImpact(name);
  }

  public ManualLowImpactVulnerability(boolean isUserInteractsEnabled, boolean isRemoveEnabled) {
    this("Anonymous", isUserInteractsEnabled, isRemoveEnabled);
  }

  public ManualLowImpactVulnerability() {
    this("Anonymous");
  }

  public class Impact extends Vulnerability.Impact {
    private Set<AttackStep> _cacheChildrenImpact;

    public Impact(String name) {
      super(name);
    }

    @Override
    public void updateChildren(Set<AttackStep> attackSteps) {
      if (_cacheChildrenImpact == null) {
        _cacheChildrenImpact = new HashSet<>();
        _cacheChildrenImpact.add(lowImpact);
      }
      for (AttackStep attackStep : _cacheChildrenImpact) {
        attackStep.updateTtc(this, ttc, attackSteps);
      }
    }

    @Override
    public Set<AttackStep> getAttackStepChildren() {
      var tmp = super.getAttackStepChildren();
      tmp.add(lowImpact);
      return tmp;
    }

    @Override
    public double localTtc() {
      return ttcHashMap.get("ManualLowImpactVulnerability.impact");
    }
  }

  public class LowImpact extends AttackStepMin {
    private Set<AttackStep> _cacheChildrenLowImpact;

    private Set<AttackStep> _cacheParentLowImpact;

    public LowImpact(String name) {
      super(name);
    }

    @Override
    public void updateChildren(Set<AttackStep> attackSteps) {
      if (_cacheChildrenLowImpact == null) {
        _cacheChildrenLowImpact = new HashSet<>();
        if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application != null) {
            _cacheChildrenLowImpact.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application.read);
          }
        }
        if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct != null) {
            _cacheChildrenLowImpact.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct.readApplication);
          }
        }
        if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application != null) {
            _cacheChildrenLowImpact.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application.modify);
          }
        }
        if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct != null) {
            _cacheChildrenLowImpact.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct.modifyApplication);
          }
        }
        if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application != null) {
            _cacheChildrenLowImpact.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application.deny);
          }
        }
        if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
          if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct != null) {
            _cacheChildrenLowImpact.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct.denyApplication);
          }
        }
      }
      for (AttackStep attackStep : _cacheChildrenLowImpact) {
        attackStep.updateTtc(this, ttc, attackSteps);
      }
    }

    @Override
    public Set<AttackStep> getAttackStepChildren() {
      var tmp = super.getAttackStepChildren();
      if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application != null) {
          tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application.read);
        }
      }
      if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct != null) {
          tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct.readApplication);
        }
      }
      if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application != null) {
          tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application.modify);
        }
      }
      if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct != null) {
          tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct.modifyApplication);
        }
      }
      if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application != null) {
          tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).application.deny);
        }
      }
      if (ManualLowImpactVulnerability.this instanceof ManualLowImpactVulnerability) {
        if (((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct != null) {
          tmp.add(((org.mal_lang.joh_mal_bugs.example1.test.ManualLowImpactVulnerability) ManualLowImpactVulnerability.this).softwareProduct.denyApplication);
        }
      }
      return tmp;
    }

    @Override
    public void setExpectedParents() {
      super.setExpectedParents();
      if (_cacheParentLowImpact == null) {
        _cacheParentLowImpact = new HashSet<>();
        _cacheParentLowImpact.add(impact);
      }
      for (AttackStep attackStep : _cacheParentLowImpact) {
        addExpectedParent(attackStep);
      }
    }

    @Override
    public Set<AttackStep> getAttackStepParents() {
      var tmp = super.getAttackStepParents();
      tmp.add(impact);
      return tmp;
    }

    @Override
    public double localTtc() {
      return ttcHashMap.get("ManualLowImpactVulnerability.lowImpact");
    }
  }
}
